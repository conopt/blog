---
layout: post_page
title: "SRM596"
---

h4. DIV1

#### 250 - IncrementAndDoubling {#incrementanddoubling .prob-title}

给一个数列, 要求从全0数列变换到给定数列, 允许操作有

-   使某个数自增
-   整个数列翻倍

**SOL:**

pre. 看到这两个操作, 可以肯定解法与二进制有关\
所有小的数都可以在得到最大的数之间「顺便」完成, 所需的操作仅是自增\
所以答案就是 最大的数的位数-1+整个数列中二进制表示的1的个数

#### 500 - BitwiseAnd {#bitwiseand .prob-title}

给一个数集\$S\$, 要求将这个集合大小扩展到\$N\$, \$N\\le{50}\$\
使得这个集合满足

-   \$\\forall i,j\\in{S} (i\\neq{j}), \\quad i\\&j\>0\$
-   \$\\forall i,j,k\\in{S} (i,j,k互不相同), \\quad i\\&j\\&k=0\$

**SOL:**

pre.
对于一个数集,统计出集合内所有数字二进制表示第i位为1的次数count\[i\]\
那么符合条件的集合所对应的count数组, 只能包括0和2\
首先如果所给数集已经不满足题设条件，那么无解\
接下来考虑如何添数\
令pos\[i\]代表数集中第i个数s的所有可行位置j,
可行位置j满足count\[j\]1 && s的第j位为1(也就是说 整个数集只有s这个数的第j位是1)
那么数集可以扩展的大小\$\\Delta=min(pos\[i\].size)\$
如果\$\\Delta\$不够大，那么无解(注意原数集为空的特殊情况)
根据以上规则以及答案字典序最小 可以得到一个构造方法
新添加的数 \$q=\\sum\\limits\_{s\\in{subset}}2\^{pos\[s\].front}\$
这时候 \$\\{q\\}\$ 这个新添加的集合本身还不满足题目条件
需要对 \$\\{q\\}\$ 中的元素两两添加共同的二进制位i, 也就是count\[i\]0\
为了满足字典序最小, 需要从\$\\{q\\}\$中最小的数对开始添加最小的i\
根据题目要求 如果添加过程中 \$q\>2\^{60}-1\$ 则无解\
最后结果就是排序后的原数集和添加的集合的并

#### DIV2

#### 1000 - SparseFactorialDiv2 {#sparsefactorialdiv2 .prob-title}

\\( F (n) = \\prod\\limits\_{0\\le i\^2\<n} n-i\^2 \\)\
给素数\$p\<1000\$ , \$lo, hi \\le 10\^{12} \$\
求\$\[lo,hi\]\$中有多少个\$n\$满足 \$p\|F(n)\$

**SOL:**

pre. 由于\$p\$是素数, 所以 \$p\|F(n) \\equiv \\exists i, p\|n-i\^2\$\
一个很直接的想法就是将\$n\$表示为\$i\^2+tp(t\\ge 0)\$的形式\
那么通过枚举\$i\$,
可以在\$O(1)\$的时间内计算出\$\[lo,hi\]\$中符合\$i\^2+tp\$形式的数的个数,
这时候枚举的复杂度为\$O(\\sqrt{n})\$\
问题在于,这样会出现重复计算\
例如 \$p=5\$ 时 \$3\^2+9p = 7\^2+p\$\
即 \$i\^2+tp = j\^2+vp\$\
观察这个式子 可以发现重复的情况就是\$i\^2\\equiv j\^2 \\mod{p}\$\
而且如果\$i\<j\$, 那么\$ i\^2+p\\mathbb{Z} \\supset j\^2+p\\mathbb{Z}\$\
所以只要从小到大枚举i, 如果\$i\^2\\mod{p}\$已经被计算过了, 就直接跳过\
复杂度 \$O(\\sqrt{n})\$
